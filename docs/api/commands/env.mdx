---
title: 'env | Cypress Documentation'
description: Securely read environment variables in Cypress tests using cy.env(). Learn syntax, examples, security benefits, and how to migrate from Cypress.env().
sidebar_label: env
---

<ProductHeading product="app" />

# env

Safely retrieve environment variables set in your Cypress configuration from within Cypress tests.

`cy.env()` is the recommended way to read environment variables at runtime without exposing your entire environment to the browser.

:::caution

**Read-Only Command**

`cy.env()` is **read-only** and can only retrieve environment variables. It cannot set or modify environment variables. To set environment variables, use one of the supported methods described in the [Environment Variables](/app/references/environment-variables) guide.

:::

## Syntax

```javascript
cy.env(args)
cy.env(args, options)
```

### Usage

<Icon name="check-circle" color="green" /> **Correct Usage**

```javascript
// Get a single environment variable
cy.env(['apiUrl']).then(({ apiUrl }) => {
  cy.request(`${apiUrl}/users`).its('status').should('eq', 200)
})

// Get multiple environment variables
cy.env(['apiUrl', 'apiKey']).then(({ apiUrl, apiKey }) => {
  cy.request({
    url: `${apiUrl}/users`,
    headers: { Authorization: `Bearer ${apiKey}` },
  })
    .its('status')
    .should('eq', 200)
})

// With options
cy.env(['apiUrl'], {
  timeout: 10000,
  log: false,
}).then(({ apiUrl }) => {
  // Use apiUrl
})
```

:::cypress-config-example

```javascript
{
  env: {
    apiUrl: 'https://api.example.com',
    apiKey: 'secret-key-12345',
    environment: 'staging',
  },
}
```

:::

### Arguments

<Icon name="angle-right" /> **args _(String[])_**

An array of variable names to retrieve from Cypress. These environment variables
can be set via any of the methods described in the [Environment Variables](/app/references/environment-variables) guide except for the [`Test Configuration`](/app/references/configuration#Test-Configuration) method.

If a variable requested is not set, the key will be returned as `undefined`.

<Icon name="angle-right" /> **options _(Object)_**

Pass in an options object to change the default behavior of `cy.env()`.

| Option    | Default | Description                                                                                                                                           |
| --------- | ------- | ----------------------------------------------------------------------------------------------------------------------------------------------------- |
| `log`     | `true`  | Displays the command in the [Command log](/app/core-concepts/open-mode#Command-Log). This only logs the environment variable keys and not the values. |
| `timeout` | 4000    | Time to wait for `cy.env()` to resolve before [timing out](#Timeouts).                                                                                |

<HeaderYields />

`cy.env()` yields the values found for the environment variable keys requested in an object.

```javascript
cy.env(['apiUrl', 'apiKey']).then((env) => {
  // env = { apiUrl: 'https://api.example.com', apiKey: 'secret-key-12345' }
})
```

## Examples

### Single Variable

Get a single environment variable:

```javascript
cy.env(['apiUrl']).then(({ apiUrl }) => {
  cy.visit(apiUrl)
})
```

### Multiple Variables

Get multiple environment variables at once:

```javascript
cy.env(['apiUrl', 'apiKey', 'timeout']).then(({ apiUrl, apiKey, timeout }) => {
  cy.request({
    url: `${apiUrl}/users`,
    headers: { Authorization: `Bearer ${apiKey}` },
    timeout: timeout || 5000,
  })
})
```

### Using in `before()` Hooks

Store environment variables for use across multiple tests:

```javascript
describe('API tests', () => {
  let apiBaseUrl

  before(() => {
    cy.env(['apiBaseUrl']).then(({ apiBaseUrl: url }) => {
      apiBaseUrl = url
    })
  })

  it('can make requests', () => {
    cy.request(`${apiBaseUrl}/users`).its('status').should('eq', 200)
  })
})
```

### Handling Undefined Variables

Variables that are not set will be `undefined`:

```javascript
cy.env(['requiredVar', 'optionalVar']).then(({ requiredVar, optionalVar }) => {
  if (requiredVar === undefined) {
    throw new Error('requiredVar must be set in Cypress configuration')
  }

  // Use optionalVar only if it's defined
  if (optionalVar) {
    // Use optionalVar
  }
})
```

### Chaining with Other Commands

Since `cy.env()` is a Cypress command, it can be chained with other commands:

```javascript
cy.env(['baseUrl']).then(({ baseUrl }) => {
  cy.visit(baseUrl)
  cy.get('h1').should('be.visible')
})
```

### Custom Commands

Create custom commands that use `cy.env()`:

```javascript
// cypress/support/commands.js
Cypress.Commands.add('apiRequest', (endpoint, options = {}) => {
  cy.env(['apiUrl', 'apiKey']).then(({ apiUrl, apiKey }) => {
    cy.request({
      url: `${apiUrl}${endpoint}`,
      headers: {
        Authorization: `Bearer ${apiKey}`,
        ...options.headers,
      },
      ...options,
    })
  })
})

// In your test
cy.apiRequest('/users').its('status').should('eq', 200)
```

### Suppressing Command Log

Hide the command from the command log:

```javascript
cy.env(['apiKey'], { log: false }).then(({ apiKey }) => {
  // Command won't appear in command log
  // Useful for potentially sensitive keys
})
```

## Rationale

`cy.env()` is a secure way to retrieve environment variables from your Cypress configuration.

### Security Benefits

Unlike [`Cypress.env()`](/api/cypress-api/env), which hydrates **all** environment variables into the browser, `cy.env()` only retrieves the specific variables you request. This provides several security benefits:

1. **Selective Access**: Only the variables you explicitly request are accessible, reducing the attack surface
2. **No Automatic Hydration**: Environment variables are not automatically serialized into the browser
3. **Better Control**: You have explicit control over which variables are accessed, making it easier to audit and secure your test code
4. **Cross-Origin Safety**: When using [`cy.origin()`](/api/commands/origin), only requested variables are passed to cross-origin contexts

### Migration from `Cypress.env()`

`cy.env()` replaces the deprecated [`Cypress.env()`](/api/cypress-api/env) API. Cypress recommends migrating to `cy.env()` as soon as possible to avoid potential security risks.

Once you've migrated all `Cypress.env()` calls to `cy.env()`, you can disable the `allowCypressEnv` configuration option to prevent future use of `Cypress.env()`:

:::cypress-config-example

```javascript
{
  allowCypressEnv: false,
}
```

:::

Please see the [Migration Guide](/app/references/migration-guide#Migrating-away-from-Cypressenv) for detailed migration instructions.

## Notes

### Read-Only

`cy.env()` is **read-only** and cannot be used to set environment variables. Unlike `Cypress.env()`, which allowed setting variables at runtime, `cy.env()` only retrieves values that have been configured elsewhere.

To set environment variables, use one of these methods:

- [Cypress configuration file](/app/references/environment-variables#Option-1-configuration-file)
- [`cypress.env.json` file](/app/references/environment-variables#Option-2-cypressenvjson)
- [OS-level environment variables with `CYPRESS_` prefix](/app/references/environment-variables#Option-3-CYPRESS_)
- [Command-line arguments with `--env`](/app/references/environment-variables#Option-4---env)
- [Dynamic configuration in `setupNodeEvents`](/app/references/environment-variables)

### Test Configuration

Environment variables cannot be set using [test configuration](/app/references/configuration#Test-Configuration) when `allowCypressEnv` is set to `false`. This is a security feature to prevent exposing sensitive data through test configuration.

### Variable Names

Variable names are case-sensitive and must match exactly how they are defined in your configuration:

```javascript
// Configuration
{
  env: {
    apiUrl: 'https://api.example.com',
    API_URL: 'https://api.example.com',  // Different variable
  }
}

// In test
cy.env(['apiUrl'])  // Gets 'https://api.example.com'
cy.env(['API_URL']) // Gets 'https://api.example.com' (different variable)
```

### Undefined Variables

If a requested variable is not set, it will be `undefined` in the returned object:

```javascript
cy.env(['missingVar']).then(({ missingVar }) => {
  // missingVar is undefined if not set in configuration
})
```

## Timeouts

`cy.env()` will wait for the command to resolve before timing out. The default timeout is `4000ms`, but this can be configured:

```javascript
cy.env(['apiUrl'], { timeout: 10000 }).then(({ apiUrl }) => {
  // Will wait up to 10 seconds for the command to resolve
})
```

## History

| Version                                      | Changes                  |
| -------------------------------------------- | ------------------------ |
| [15.10.0](/app/references/changelog#15-10-0) | `cy.env()` command added |

## See also

- [Migration Guide: migrating away from `Cypress.env()`](/app/references/migration-guide#Migrating-away-from-Cypressenv)
- [`Cypress.env()`](/api/cypress-api/env) (deprecated)
- [Environment Variables](/app/references/environment-variables)
- [Configuration](/app/references/configuration)
