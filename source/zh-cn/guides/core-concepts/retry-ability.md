---
title: é‡è¯•æœºåˆ¶
---

{% note info %}
# {% fa fa-graduation-cap %} é€šè¿‡è¿™ç¯‡æ–‡æ¡£ä½ å°†ä¼šå­¦ä¹ åˆ°
- Cypresså¦‚ä½•é‡è¯•å‘½ä»¤å’Œæ–­è¨€
- å‘½ä»¤åœ¨ä»€ä¹ˆæ—¶å€™é‡è¯•ä»€ä¹ˆæ—¶å€™ä¸é‡è¯•
- å¦‚ä½•è§£å†³ä¸€äº›ç‰‡çŠ¶æµ‹è¯•çš„æƒ…å†µ
{% endnote %}

Cypressçš„æ ¸å¿ƒåŠŸèƒ½æ—¶å¸®åŠ©æµ‹è¯•åŠ¨æ€Webåº”ç”¨ç¨‹åºï¼Œå®ƒå…·æœ‰é‡è¯•æœºåˆ¶ã€‚è¿™å°±åƒæ±½è½¦ä¸­çš„è‡ªåŠ¨å˜é€Ÿå™¨ä¸€æ ·ï¼Œä½ é€šå¸¸æ„ŸçŸ¥ä¸åˆ°å®ƒåœ¨å·¥ä½œã€‚ä½†æ˜¯äº†è§£å®ƒçš„å·¥ä½œåŸç†å°†æœ‰åŠ©äºä½ ç”¨æ›´å°‘çš„è¿è¡Œæ—¶é—´æ¥æ›´å¿«çš„ç¼–å†™æµ‹è¯•ã€‚

# å‘½ä»¤å’Œæ–­è¨€

åœ¨Cypressæµ‹è¯•ä»£ç ä¸­å¯ä»¥è°ƒç”¨ä¸¤ç§ç±»å‹çš„æ–¹æ³•ï¼š**å‘½ä»¤** å’Œ **æ–­è¨€**ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„æµ‹è¯•ä»£ç ä¸­æœ‰6ä¸ªå‘½ä»¤å’Œ2ä¸ªæ–­è¨€ã€‚

```javascript
it('creates 2 items', function () {
  cy.visit('/')                       // å‘½ä»¤
  cy.focused()                        // å‘½ä»¤
    .should('have.class', 'new-todo') // æ–­è¨€
  cy.get('.new-todo')                 // å‘½ä»¤
    .type('todo A{enter}')            // å‘½ä»¤
    .type('todo B{enter}')            // å‘½ä»¤
  cy.get('.todo-list li')             // å‘½ä»¤
    .should('have.length', 2)         // æ–­è¨€
})
```

{% url "å‘½ä»¤æ—¥å¿—" test-runner#Command-Log %} ä¼šæ˜¾ç¤ºå‘½ä»¤å’Œæ–­è¨€ï¼Œæµ‹è¯•é€šè¿‡çš„æ–­è¨€ä¼šæ˜¾ç¤ºä¸ºç»¿è‰²ã€‚

{% imgTag /img/guides/retry-ability/commands-assertions.png "ommands and assertions" %}

è®©æˆ‘ä»¬çœ‹çœ‹æœ€åä¸€ä¸ªå‘½ä»¤å’Œæ–­è¨€ï¼š

```javascript
cy.get('.todo-list li')     // command
  .should('have.length', 2) // assertion
```

å› ä¸ºç°ä»£Webåº”ç”¨ç¨‹åºä¸­æ²¡æœ‰ä»»ä½•å†…å®¹æ˜¯åŒæ­¥çš„ï¼Œæ‰€ä»¥Cypressä¸èƒ½åœ¨æ‰€æœ‰DOMå…ƒç´ é‡Œé¢å»æŸ¥æ‰¾`todo-list`ï¼Œå¹¶æ£€æŸ¥å®ƒä»¬æ˜¯å¦åªæœ‰2ä¸ªã€‚æœ‰å¾ˆå¤šä¾‹å­è¯´æ˜ä¸ºä»€ä¹ˆè¿™ç§æ–¹æ³•æ•ˆæœä¸å¥½ã€‚

- å¦‚æœåº”ç”¨ç¨‹åºåœ¨è¿™äº›å‘½ä»¤è¿è¡Œæ—¶æ²¡æœ‰æ›´æ–°DOMï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆåŠï¼Ÿ
- å¦‚æœåº”ç”¨ç¨‹åºåœ¨å¡«å……DOMå…ƒç´ ä¹‹å‰ç­‰å¾…å…¶åç«¯å“åº”ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆåŠï¼Ÿ
- å¦‚æœåº”ç”¨ç¨‹åºåœ¨DOMæ˜¾ç¤ºä¹‹å‰è¿›è¡Œäº†ä¸€äº›å¯†é›†çš„è®¡ç®—ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆåŠï¼Ÿ

å› æ­¤ï¼ŒCypressçš„ {% url `cy.get` get %} å‘½ä»¤å¿…é¡»æ›´åŠ æ™ºèƒ½ï¼Œå¹¶æœŸæœ›åº”ç”¨ç¨‹åºå¯èƒ½ä¼šæ›´æ–°DOMã€‚`cy.get()` æŸ¥è¯¢åº”ç”¨ç¨‹åºçš„DOMç»“æ„ï¼Œæ‰¾åˆ°ä¸ä¹‹åŒ¹é…çš„å…ƒç´ ï¼Œç„¶åæ‰§è¡Œå®ƒçš„æ–­è¨€ï¼ˆåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯ï¼š`should('have.length', 2)`ï¼‰ã€‚

- âœ… å¦‚æœ `cy.get()` å‘½ä»¤åé¢çš„æ–­è¨€é€šè¿‡ï¼Œåˆ™å‘½ä»¤æˆåŠŸå®Œæˆã€‚
- ğŸš¨ å¦‚æœ `cy.get()` å‘½ä»¤åé¢çš„æ–­è¨€å¤±è´¥ï¼Œé‚£ä¹ˆ `cy.get()` å‘½ä»¤å°†å†æ¬¡é‡æ–°æŸ¥è¯¢åº”ç”¨ç¨‹åºçš„DOMç»“æ„ã€‚ç„¶åCypresså°†å†æ¬¡å°è¯•å¯¹æ¥è‡ª`cy.get()`çš„å…ƒç´ è¿›è¡Œæ–­è¨€ã€‚å¦‚æœæ–­è¨€ä»ç„¶å¤±è´¥ï¼Œ`cy.get()`å°†å°è¯•å†æ¬¡é‡æ–°æŸ¥è¯¢DOMç»“æ„ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°`cy.get()`å‘½ä»¤è¶…æ—¶ã€‚

é‡è¯•èƒ½åŠ›å…è®¸æµ‹è¯•åœ¨æ–­è¨€é€šè¿‡åç«‹å³å®Œæˆæ¯ä¸ªå‘½ä»¤ï¼Œè€Œæ— éœ€ç¡¬ç¼–ç ç­‰å¾…ã€‚å¦‚æœä½ çš„åº”ç”¨ç¨‹åºéœ€è¦å‡ æ¯«ç§’ç”šè‡³å‡ ç§’æ¥æ¸²æŸ“æ¯ä¸ªDOMå…ƒç´  - è¿™æ²¡ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Œæµ‹è¯•ç¨‹åºæ ¹æœ¬ä¸éœ€è¦æ”¹å˜ã€‚ä¾‹å¦‚ï¼šåœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¼•å…¥3ç§’çš„äººä¸ºå»¶è¿Ÿç”¨äºåˆ·æ–°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºUIï¼š

```javascript
app.TodoModel.prototype.addTodo = function (title) {
  this.todos = this.todos.concat({
    id: Utils.uuid(),
    title: title,
    completed: false
  })

  // let's trigger the UI to render after 3 seconds
  setTimeout(() => {
    this.inform()
  }, 3000)
}
```

æˆ‘çš„æµ‹è¯•ä»ç„¶èƒ½é€šè¿‡ï¼æœ€åçš„ `cy.get('.todo-list')` å’Œæ–­è¨€ `should('have.length', 2)`æ¸…æ™°çš„æ˜¾ç¤ºäº†æ—‹è½¬ç­‰å¾…å›¾æ ‡ï¼Œè¿™æ„å‘³ç€Cypressæ­£åœ¨é‡æ–°æŸ¥è¯¢å®ƒä»¬ã€‚

{% imgTag /img/guides/retry-ability/retry-2-items.gif "Retrying finding 2 items" %}

åœ¨DOMæ›´æ–°åçš„å‡ æ¯«ç§’å†…ï¼Œ`cy.get()` æ‰¾åˆ°äº†ä¸¤ä¸ªå…ƒç´ å¹¶ä¸” `should('have.length', 2)` æ–­è¨€é€šè¿‡ã€‚

# å¤šä¸ªæ–­è¨€

å•ä¸ªå‘½ä»¤åè·Ÿç€å¤šä¸ªæ–­è¨€åœ¨é‡è¯•çš„æ—¶å€™å°†æŒ‰ç…§é¡ºåºæŒ¨ä¸ªå°è¯•ã€‚å› æ­¤ï¼Œå½“ç¬¬ä¸€ä¸ªæ–­è¨€é€šè¿‡ï¼Œå°†ä½¿ç”¨ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªæ–­è¨€é‡è¯•è¯¥å‘½ä»¤ã€‚å½“ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªæ–­è¨€é€šè¿‡æ—¶ï¼Œå°†ä½¿ç”¨ç¬¬ä¸€ä¸ªã€ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªæ–­è¨€é‡è¯•è¯¥å‘½ä»¤ï¼Œä»¥æ­¤ç±»æ¨ã€‚

ä¾‹å¦‚ï¼šä¸‹é¢çš„æµ‹è¯•æœ‰ {% url `.should()` should %} å’Œ {% url `.and()` and %} æ–­è¨€ã€‚ `.and()`æ˜¯`.should()`çš„åˆ«åå‘½ä»¤ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªæ–­è¨€å®é™…ä¸Šæ˜¯{% url `.should(cb)` should#Function %}å‡½æ•°å½¢å¼çš„è‡ªå®šä¹‰å›è°ƒæ–­è¨€ï¼Œè¿™å…¶ä¸­åˆåŒ…å«2ä¸ª {% url `expect` assertions#BDD-Assertions %} æ–­è¨€ã€‚

```javascript
cy.get('.todo-list li')     // command
  .should('have.length', 2) // assertion
  .and(($li) => {
    // 2 more assertions
    expect($li.get(0).textContent, 'first item').to.equal('todo a')
    expect($li.get(1).textContent, 'second item').to.equal('todo B')
  })
```

å› ä¸ºç¬¬äºŒä¸ªæ–­è¨€ `expect($li.get(0).textContent, 'first item').to.equal('todo a')` å¤±è´¥ï¼Œæ‰€ä»¥æ°¸è¿œä¸ä¼šåˆ°è¾¾ç¬¬ä¸‰ä¸ªæ–­è¨€ã€‚è¶…æ—¶åå‘½ä»¤å¤±è´¥ï¼Œå‘½ä»¤æ—¥å¿—æ­£ç¡®çš„æ˜¾ç¤ºäº†ç¬¬ä¸€ä¸ªé‡åˆ°çš„æ–­è¨€`should('have.length', 2)`é€šè¿‡äº†ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªæ–­è¨€å’Œå‘½ä»¤æœ¬èº«æ˜¯å¤±è´¥çš„ã€‚

{% imgTag /img/guides/retry-ability/second-assertion-fails.gif "Retrying multiple assertions" %}

# ä¸æ˜¯æ¯ä¸ªå‘½ä»¤éƒ½è¢«é‡è¯•

Cypressåªé‡è¯•æŸ¥è¯¢DOMç»“æ„çš„å‘½ä»¤ï¼š{% url `cy.get()` get %}ï¼Œ {% url `.find()` find %}ï¼Œ {% url `.contains()` contains %}ç­‰ç­‰ã€‚ä½ å¯ä»¥é€šè¿‡æŸ¥çœ‹APIæ–‡æ¡£ä¸­çš„â€œæ–­è¨€â€éƒ¨åˆ†æ¥æ£€æŸ¥ç‰¹å®šçš„å‘½ä»¤æ˜¯å¦ä¼šé‡è¯•ã€‚ä¾‹å¦‚ï¼š{% url `.first()` first %}çš„â€œæ–­è¨€éƒ¨åˆ†â€å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªå‘½ä»¤ä¼šä¸€ç›´é‡è¯•ç›´åˆ°æ‰€æœ‰çš„æ–­è¨€éƒ½é€šè¿‡ã€‚

{% assertions existence .first %}

## ä¸ºä»€ä¹ˆæœ‰äº›å‘½ä»¤*ä¸*é‡è¯•ï¼Ÿ

å½“å‘½ä»¤å¯èƒ½ä¼šæ›´æ”¹è¢«æµ‹è¯•åº”ç”¨ç¨‹åºçš„çŠ¶æ€æ—¶ï¼Œä¸ä¼šé‡è¯•å‘½ä»¤ã€‚ä¾‹å¦‚ï¼šCypressä¸ä¼šé‡è¯• {% url '.click()' click %} å‘½ä»¤ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šæ”¹å˜åº”ç”¨ç¨‹åºä¸­çš„æŸäº›å†…å®¹ã€‚

{% note warning %}
åœ¨å¾ˆå°çš„æ¦‚ç‡ä¸‹ä½ å¯èƒ½æƒ³é‡è¯•`.click()`è¿™æ ·çš„å‘½ä»¤ã€‚æˆ‘ä»¬æè¿°äº†ä¸€ä¸ªæ¡ˆä¾‹ï¼Œäº‹ä»¶ç›‘å¬å™¨éœ€è¦åœ¨çª—å£å¼¹å‡ºåä¸€æ®µæ—¶é—´æ‰ä¼šç”Ÿæ•ˆï¼Œè¿™æ ·å¯¼è‡´`.click()`å‘½ä»¤æ— æ³•æŒ‰ç…§é¢„æœŸæ¥æ‰§è¡Œã€‚åœ¨è¿™ç§ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œä½ å¯èƒ½å¸Œæœ›â€œä¸æ–­ç‚¹å‡»â€ç›´åˆ°ç‚¹å‡»äº‹ä»¶è¢«æ³¨å†Œï¼Œç‚¹å‡»åå¯¹è¯æ¡†æ¶ˆå¤±ã€‚æ›´å¤šè¯¦ç»†ä¿¡æ¯å¯ä»¥å‚è€ƒæˆ‘ä»¬çš„åšå®¢ï¼š{% url "åœ¨æµ‹è¯•ä¸­ä»€ä¹ˆæ—¶å€™å¯ä»¥ç‚¹å‡»ï¼Ÿ" https://www.cypress.io/blog/2019/01/22/when-can-the-test-click/ %}ã€‚
{% endnote %}

# å†…ç½®æ–­è¨€

é€šå¸¸ï¼ŒCypressçš„å‘½ä»¤éƒ½æœ‰å†…ç½®æ–­è¨€ï¼Œè¿™äº›æ–­è¨€å°†å¯¼è‡´å‘½ä»¤è¢«é‡è¯•ã€‚ä¾‹å¦‚ï¼šå³ä½¿æ²¡æœ‰ä»»ä½•é™„åŠ çš„æ–­è¨€ï¼Œ{% url `.eq()` eq %}å‘½ä»¤ä¹Ÿä¼šé‡è¯•ï¼Œç›´åˆ°å®ƒåœ¨ä¹‹å‰äº§ç”Ÿçš„å…ƒç´ åˆ—è¡¨ä¸­æ‰¾åˆ°ç»™å®šç´¢å¼•çš„å…ƒç´ ã€‚

```javascript
cy.get('.todo-list li')     // command
  .should('have.length', 2) // assertion
  .eq(3)                    // command
```

{% imgTag /img/guides/retry-ability/eq.gif "Retrying built-in assertion" %}

ä¸€äº›æ— æ³•é‡è¯•çš„å‘½ä»¤ä»ç„¶å…·æœ‰å†…ç½®çš„_ç­‰å¾…_ã€‚ä¾‹å¦‚ï¼šæ­£å¦‚â€œæ–­è¨€â€éƒ¨åˆ†æ‰€æè¿°çš„é‚£æ ·ï¼Œ{% url "`.click()`" click %}ä¼šç­‰å¾…ç‚¹å‡»ï¼Œç›´åˆ°è¯¥å…ƒç´ å˜ä¸º{% url "å¯æ“ä½œ" interacting-with-elements#Actionability %}ã€‚

Cypresså°è¯•åƒäººç±»ç”¨æˆ·é‚£æ ·ä½¿ç”¨æµè§ˆå™¨ã€‚

- ç”¨æˆ·å¯ä»¥ç‚¹å‡»è¯¥å…ƒç´ å—ï¼Ÿ
- å…ƒç´ æ—¶ä¸å¯è§çš„å—ï¼Ÿ
- å…ƒç´ æ˜¯å¦åœ¨å¦ä¸€ä¸ªå…ƒç´ åé¢ï¼Ÿ
- å…ƒç´ æ˜¯å¦å…·æœ‰`disabled`å±æ€§ï¼Ÿ

`.click()`å‘½ä»¤å°†è‡ªåŠ¨ç­‰å¾…ï¼Œç›´åˆ°å¤šä¸ªå†…ç½®çš„æ–­è¨€æ£€æŸ¥é€šè¿‡ï¼Œç„¶åå®ƒå°†å°è¯•å•å‡»ä¸€æ¬¡ã€‚

# è¶…æ—¶

é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªé‡è¯•çš„å‘½ä»¤æœ€å¤šæŒç»­4ç§’ - é€šè¿‡ {% url `defaultCommandTimeout` configuration#Timeouts %} æ¥é…ç½®ã€‚ ä½ å¯ä»¥é€šè¿‡ _æ‰€æœ‰çš„_ æ–¹å¼æ¥ä¿®æ”¹è¿™ä¸ªé…ç½®é€‰é¡¹ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ï¼Œå‘½ä»¤è¡Œå‚æ•°ï¼Œç¯å¢ƒå˜é‡æˆ–è€…é€šè¿‡ä»£ç æ¥ä¿®æ”¹ã€‚

ä¾‹å¦‚ï¼Œè¦é€šè¿‡å‘½ä»¤è¡Œå°†é»˜è®¤å‘½ä»¤è¶…æ—¶è®¾ç½®ä¸º10ç§’ï¼š

```shell
cypress run --config defaultCommandTimeout=10000
```

æœ‰å…³è¦†ç›–æ­¤é€‰é¡¹çš„å…¶å®ƒç¤ºä¾‹ï¼Œè¯·å‚è€ƒ {% url 'Configuration: Overriding Options' configuration#Overriding-Options %}ã€‚æˆ‘ä»¬ä¸å»ºè®®ä¿®æ”¹å…¨å±€çš„è¶…æ—¶é…ç½®ã€‚ç›¸åçš„ï¼Œä½ åº”è¯¥å°† `{ timeout: ms }` å‚æ•°ä¼ é€’ç»™å‡½æ•°ç”¨äºé‡è¯•ä¸åŒçš„æ—¶é—´ã€‚ä¾‹å¦‚ï¼š

```javascript
// we've modified the timeout which affects default + added assertions
cy.get('.mobile-nav', { timeout: 10000 })
  .should('be.visible')
  .and('contain', 'Home')
```

Cypresså°†é‡è¯•æœ€å¤š10ç§’ï¼Œä»¥æ‰¾åˆ°åŒ…å«â€œHomeâ€æ–‡æœ¬çš„ `mobile-nav` ç±»çš„å¯è§å…ƒç´ ã€‚æœ‰å…³æ›´å¤šçš„ç¤ºä¾‹ï¼Œè¯·å‚è€ƒâ€œCypressç®€ä»‹â€ä¸­çš„{% url 'Timeouts' introduction-to-cypress#Timeouts %}éƒ¨åˆ†ã€‚

# åªæœ‰æœ€åä¸€ä¸ªå‘½ä»¤ä¼šè¢«é‡è¯•

è¿™æ˜¯ä¸€ä¸ªç®€çŸ­çš„æµ‹è¯•ï¼Œå®ƒå±•ç¤ºäº†ä¸€éƒ¨åˆ†æƒ…å†µã€‚

```javascript
it('adds two items', function () {
  cy.visit('/')

  cy.get('.new-todo').type('todo A{enter}')
  cy.get('.todo-list li')
    .find('label')
    .should('contain', 'todo A')

  cy.get('.new-todo').type('todo B{enter}')
  cy.get('.todo-list li')
    .find('label')
    .should('contain', 'todo B')
})
```

è¿™ä¸ªæµ‹è¯•æ¯«æ— ç–‘é—®çš„åœ¨Cypressä¸Šé€šè¿‡ã€‚

{% imgTag /img/guides/retry-ability/adds-two-items-passes.gif "Test passes" %}

ä½†æœ‰æ—¶å€™æµ‹è¯•ä¼šå¤±è´¥ - é€šå¸¸æœ¬åœ°ä¸ä¼šæµ‹è¯•å¤±è´¥ - å®ƒå‡ ä¹æ€»æ˜¯åœ¨æˆ‘ä»¬çš„æŒç»­é›†æˆæœåŠ¡å™¨ä¸Šå¤±è´¥ã€‚å½“æµ‹è¯•å¤±è´¥æ—¶ï¼Œå½•åˆ¶çš„è§†é¢‘å’Œå±å¹•æˆªå›¾æ²¡æœ‰æ˜¾ç¤ºä»»ä½•æ˜æ˜¾çš„é—®é¢˜ï¼è¿™æ˜¯æµ‹è¯•å¤±è´¥çš„è§†é¢‘ï¼š

{% imgTag /img/guides/retry-ability/adds-two-items-fails.gif "Test fails" %}

é—®é¢˜çœ‹èµ·æ¥å¾ˆå¥‡æ€ª - æˆ‘å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°åˆ—è¡¨ä¸­å‡ºç°çš„æ ‡ç­¾â€œtodo Bâ€ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆCypressæ‰¾ä¸åˆ°å®ƒï¼Ÿè¿™åˆ°åº•æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ

è¿˜è®°å¾—æˆ‘ä»¬åœ¨åº”ç”¨ç¨‹åºä»£ç ä¸­å¼•å…¥çš„å»¶è¿Ÿå¯¼è‡´æµ‹è¯•è¶…æ—¶å—ï¼Ÿåœ¨UIé‡æ–°å‘ˆç°ä¹‹å‰ï¼Œæˆ‘ä»¬æ·»åŠ äº†100msçš„å»¶è¿Ÿã€‚

```javascript
app.TodoModel.prototype.addTodo = function (title) {
  this.todos = this.todos.concat({
    id: Utils.uuid(),
    title: title,
    completed: false
  })
  setTimeout(() => {
    this.inform()
  }, 100)
}
```

å½“åº”ç”¨ç¨‹åºåœ¨æˆ‘ä»¬çš„CIæœåŠ¡å™¨ä¸Šè¿è¡Œæ—¶ï¼Œè¿™ä¸ªå»¶è¿Ÿå°±å¯èƒ½æ˜¯æˆ‘ä»¬æµ‹è¯•å¤±è´¥çš„åŸå› ã€‚ ä¸‹é¢æˆ‘ä»¬ä¸€èµ·æ¥å¯»æ‰¾ä¸‹é—®é¢˜çš„æ ¹æºã€‚åœ¨å‘½ä»¤æ—¥å¿—ä¸­ï¼Œå°†é¼ æ ‡æ‚¬åœåœ¨æ¯ä¸ªå‘½ä»¤ä¸Šæ¥æŸ¥çœ‹Cypressåœ¨æ¯ä¸ªæ­¥éª¤ä¸­æ‰¾åˆ°çš„å…ƒç´ ã€‚

åœ¨å¤±è´¥çš„æµ‹è¯•ä¸­ï¼Œç¡®å®æ‰¾åˆ°äº†ç¬¬ä¸€ä¸ªæ ‡ç­¾ï¼š

{% imgTag /img/guides/retry-ability/first-item-label.png "First item label" %}

å°†é¼ æ ‡æ‚¬åœåœ¨ç¬¬äºŒä¸ªâ€œFIND labelâ€å‘½ä»¤ä¸Š - è¿™é‡Œå‡ºäº†ä¸€ç‚¹é—®é¢˜ã€‚å®ƒæ‰¾åˆ°äº† _ç¬¬ä¸€ä¸ªæ ‡ç­¾_ï¼Œç„¶åç»§ç»­é‡æ–°æŸ¥æ‰¾æ–‡æœ¬â€œtodo Bâ€ï¼Œä½†æ˜¯ç¬¬ä¸€é¡¹ä»ç„¶æ˜¯â€œtodo Aâ€ã€‚

{% imgTag /img/guides/retry-ability/second-item-label.png "Second item label" %}

å—¯ï¼Œè¿™ç¡®å®å¾ˆå¥‡æ€ªï¼Œä¸ºä»€ä¹ˆCypressåªçœ‹ _ç¬¬ä¸€ä¸ª_ å…ƒç´ ï¼Ÿè®©æˆ‘ä»¬å°†é¼ æ ‡æ‚¬åœåœ¨â€œGET .todo-list liâ€å‘½ä»¤ä¸Šçœ‹çœ‹å®ƒ _æ‰¾åˆ°äº†ä»€ä¹ˆ_ ã€‚ å“¦ï¼Œæœ‰è¶£çš„æ˜¯ - åœ¨é‚£ä¸€åˆ»åªæœ‰ä¸€ä¸ªå…ƒç´ ã€‚

{% imgTag /img/guides/retry-ability/second-get-li.png "Second get li" %}

åœ¨æµ‹è¯•æœŸé—´ï¼Œ`cy.get('.todo-list li')` å‘½ä»¤å¾ˆå¿«çš„æ‰¾åˆ°äº†æ¸²æŸ“çš„ `<li>` å…ƒç´  - è¿™æ˜¯ç¬¬ä¸€ä¸ªä¹Ÿæ˜¯å”¯ä¸€çš„ä¸€ä¸ªâ€œtodo Aâ€å…ƒç´ ã€‚æˆ‘ä»¬çš„ç¨‹åºåœ¨ç­‰å¾…äº†100msåæ‰æŠŠâ€œtodo Bâ€å…ƒç´ é™„åŠ åˆ°åˆ—è¡¨ä¸Šã€‚ å½“ç¬¬äºŒä¸ªå…ƒç´ è¢«æ·»åŠ æ—¶ï¼ŒCypresså·²ç»â€œå®Œæˆäº†å…ƒç´ çš„æŸ¥æ‰¾â€ï¼Œå®ƒåªä½¿ç”¨ç¬¬ä¸€ä¸ª`<li>`å…ƒç´ ã€‚å®ƒåªåœ¨ç¬¬ä¸€ä¸ª`<li>`å…ƒç´ ä¸­æœç´¢`<label>`ï¼Œå®Œå…¨å¿½ç•¥äº†æ–°åˆ›å»ºçš„ç¬¬äºŒä¸ªé¡¹ç›®ã€‚

ä¸ºäº†ç¡®è®¤è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬åˆ é™¤å»¶è¿Ÿä»£ç ï¼Œçœ‹çœ‹åœ¨æµ‹è¯•é€šè¿‡çš„ä¾‹å­ä¸­å‘ç”Ÿäº†ä»€ä¹ˆã€‚

{% imgTag /img/guides/retry-ability/two-items.png "Two items" %}

å½“åº”ç”¨ç¨‹åºæ²¡æœ‰å»¶è¿Ÿæ—¶ï¼Œå®ƒä¼šåœ¨Cypresså‘½ä»¤`cy.get('.todo-list li')`è¿è¡Œä¹‹å‰å°†å…ƒç´ æ”¾å…¥DOMä¸­ã€‚`cy.get()`å°†ä¼šè¿”å›2ä¸ªå…ƒç´ ï¼Œ`.find()` å‘½ä»¤å°†ä¼šæ‰¾åˆ°æ­£ç¡®çš„æ ‡ç­¾ã€‚éå¸¸æ£’ã€‚

æ—¢ç„¶æˆ‘ä»¬å·²ç»ç†è§£äº†ä¸Šé¢é‚£ä¸ªæµ‹è¯•èƒŒåçš„çœŸæ­£åŸå› ï¼Œé‚£æˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸ºä»€ä¹ˆé»˜è®¤çš„é‡è¯•æœºåˆ¶åœ¨è¿™ç§æƒ…å†µä¸‹æ²¡æœ‰å¸®åŠ©æˆ‘ä»¬ã€‚ä¸ºä»€ä¹ˆCypressä¸èƒ½å‘ç°åæ¥æ·»åŠ çš„ç¬¬äºŒä¸ª`<li>`å…ƒç´ ï¼Ÿ

å‡ºäºå„ç§å®ç°åŸå› ï¼ŒCypresså‘½ä»¤ **ä»…** é‡è¯•æ–­è¨€ä¹‹å‰çš„ **æœ€åä¸€ä¸ªå‘½ä»¤**ã€‚åœ¨æˆ‘ä»¬çš„æµ‹è¯•ä¸­ï¼š

```javascript
cy.get('.new-todo').type('todo B{enter}')
cy.get('.todo-list li')         // queries immediately, finds 1 <li>
  .find('label')                // retried, retried, retried with 1 <li>
  .should('contain', 'todo B')  // never succeeds with only 1st <li>
```

å¹¸è¿çš„æ˜¯ï¼Œä¸€æ—¦æˆ‘ä»¬äº†è§£äº†é‡è¯•æœºåˆ¶æ˜¯å¦‚ä½•å·¥ä½œä»¥åŠæœ€åä¸€ä¸ªå‘½ä»¤å¦‚ä½•ç”¨äºæ–­è¨€é‡è¯•ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆå¥½çš„ä¿®å¤è¿™ä¸ªæµ‹è¯•ã€‚

## åˆå¹¶æŸ¥è¯¢

æˆ‘ä»¬å»ºè®®çš„ç¬¬ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯é¿å…ä¸å¿…è¦çš„æ‹†åˆ†æŸ¥è¯¢å…ƒç´ çš„å‘½ä»¤ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨`cy.get()`æŸ¥è¯¢å…ƒç´ ï¼Œç„¶åä½¿ç”¨`.find()`ä»è¯¥å…ƒç´ åˆ—è¡¨ä¸­æŸ¥è¯¢ã€‚æˆ‘ä»¬å¯ä»¥å°†ä¸¤ä¸ªå•ç‹¬çš„æŸ¥è¯¢åˆå¹¶ä¸ºä¸€ä¸ª -  å¼ºåˆ¶é‡è¯•ç»„åˆæŸ¥è¯¢ã€‚

```javascript
it('adds two items', function () {
  cy.visit('/')

  cy.get('.new-todo').type('todo A{enter}')
  cy.get('.todo-list li label')   // 1 query command
    .should('contain', 'todo A')  // assertion

  cy.get('.new-todo').type('todo B{enter}')
  cy.get('.todo-list li label')   // 1 query command
    .should('contain', 'todo B')  // assertion
})
```

ä¸ºäº†æ˜¾ç¤ºé‡è¯•æ¬¡æ•°ï¼Œæˆ‘å°†åº”ç”¨ç¨‹åºçš„äººå·¥å»¶è¿Ÿå¢åŠ åˆ°500msã€‚ç°åœ¨æµ‹è¯•æ€»æ˜¯é€šè¿‡ï¼Œ å› ä¸ºé‡è¯•äº†æ•´ä¸ªé€‰æ‹©å™¨ã€‚å½“ç¬¬äºŒä¸ªâ€œtodo Bâ€å…ƒç´ æ·»åŠ åˆ°DOMæ—¶ï¼Œå®ƒä¼šæ‰¾åˆ°åŒ…å«2ä¸ªå…ƒç´ çš„åˆ—è¡¨ã€‚

{% imgTag /img/guides/retry-ability/combined-selectors.gif "Combined selector" %}

ç±»ä¼¼çš„ï¼Œå½“ä½¿ç”¨{% url `.its()` its %} å‘½ä»¤å¤„ç†æ·±åº¦åµŒå¥—çš„JavaScriptå±æ€§æ—¶ï¼Œå°½é‡ä¸è¦å°†å®ƒåˆ†å‰²ä¸ºå¤šä¸ªè°ƒç”¨ã€‚ç›¸åçš„ï¼Œä½¿ç”¨`.`åˆ†éš”ç¬¦å°†å±æ€§åç§°ç»„åˆæˆä¸€ä¸ªè°ƒç”¨ï¼š

```javascript
// ğŸ›‘ ä¸æ¨è
// åªæœ‰æœ€åä¸€ä¸ª`its`ä¼šè¢«é‡è¯•
cy.window()
  .its('app')             // è¿è¡Œä¸€æ¬¡
  .its('model')           // è¿è¡Œä¸€æ¬¡
  .its('todos')           // é‡è¯•
  .should('have.length', 2)

// âœ… æ¨è
cy.window()
  .its('app.model.todos') // é‡è¯•
  .should('have.length', 2)
```

æœ‰å…³å®Œæ•´ç¤ºä¾‹ï¼Œè¯·å‚è€ƒ{% url 'Set flag to start tests' https://glebbahmutov.com/blog/set-flag-to-start-tests/ %} çš„åšå®¢ã€‚

## äº¤æ›¿ä½¿ç”¨å‘½ä»¤å’Œæ–­è¨€

è¿™é‡Œè¿˜æœ‰å¦å¤–ä¸€ç§æ–¹å¼æ¥ä¿®å¤ä¸Šé¢çš„æµ‹è¯•ã€‚æ— è®ºå†™å¤šé•¿çš„æµ‹è¯•ï¼Œæˆ‘ä»¬éƒ½å»ºè®®äº¤æ›¿ä½¿ç”¨å‘½ä»¤å’Œæ–­è¨€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘å°†åœ¨`cy.get()`å‘½ä»¤ä¹‹åï¼Œ`.find()`å‘½ä»¤ä¹‹å‰æ·»åŠ ä¸€ä¸ªæ–­è¨€ã€‚

```javascript
it('adds two items', function () {
  cy.visit('/')

  cy.get('.new-todo').type('todo A{enter}')
  cy.get('.todo-list li')         // command
    .should('have.length', 1)     // assertion
    .find('label')                // command
    .should('contain', 'todo A')  // assertion

  cy.get('.new-todo').type('todo B{enter}')
  cy.get('.todo-list li')         // command
    .should('have.length', 2)     // assertion
    .find('label')                // command
    .should('contain', 'todo B')  // assertion
})
```

{% imgTag /img/guides/retry-ability/alternating.png "Passing test" %}

æµ‹è¯•é€šè¿‡äº†ï¼Œå› ä¸ºç¬¬äºŒä¸ª `cy.get('.todo-list li')` è¢«è‡ªå·±çš„æ–­è¨€`.should('have.length', 2)`é‡è¯•äº†ã€‚åªæœ‰åœ¨æˆåŠŸæ‰¾åˆ°2ä¸ª `<li>` å…ƒç´ ï¼Œ`.find('label')`å‘½ä»¤å’Œå¯¹åº”çš„æ–­è¨€æ‰å¼€å§‹ï¼Œåˆ°ç°åœ¨ä¸ºæ­¢ï¼Œå®ƒèƒ½å¤Ÿæ­£ç¡®æŸ¥è¯¢äº†å¸¦æœ‰æ­£ç¡®â€œtodo Bâ€æ ‡ç­¾çš„å…ƒç´ ã€‚

# å…¶å®ƒå‚è€ƒ

- ä½ å¯ä»¥ä¸ºè‡ªå·±çš„ {% url "custom commands" custom-commands %}æ·»åŠ é‡è¯•åŠŸèƒ½ï¼Œå¯ä»¥å‚è€ƒ {% url 'this pull request to cypress-xpath' https://github.com/cypress-io/cypress-xpath/pull/12/files %}ã€‚
- ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªç¬¬ä¸‰æ–¹æ’ä»¶æ¥é‡è¯•é™„åŠ äº†æ–­è¨€çš„ä»»ä½•åŠŸèƒ½ï¼š{% url cypress-pipe https://github.com/NicholasBoll/cypress-pipe %}ã€‚
- è¯·å‚è€ƒ{% url "Cypress should callback" https://glebbahmutov.com/blog/cypress-should-callback/ %} ä¸­çš„é‡è¯•æœºåˆ¶ç¤ºä¾‹ã€‚
