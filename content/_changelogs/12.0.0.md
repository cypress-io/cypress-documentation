## 12.0.0

_Released 12/06/2022_

**Summary:** ...Notes below...

**Breaking Changes:**

- Cypress dropped support for Node 12. Use Node 14, Node 16 or Node 18+.
  Addressed in [#24885](https://github.com/cypress-io/cypress/pull/24885).
- The `Cookies.defaults` and `Cookies.preserveOnce` APIs have been removed. Use
  the new [`cy.session()`](/api/commands/session) command to preserve cookies
  between tests. Addresses
  [#21472](https://github.com/cypress-io/cypress/issues/21472).
- The `cy.server()` and `cy.route()` commands have been removed. Additionally,
  the corresponding `Cypress.Server.defaults` API has also been removed. Use the
  [`cy.intercept()`(/api/commands/intercept) command to stub network responses
  and requests. Addresses
  [#22126](https://github.com/cypress-io/cypress/issues/22126).
- The Cookie commands now uses the `hostname` the as the domain by default
  instead of the `superdomain`. This change aligns Cypress' cookie rules with
  the browser cookie rules. This may affect what cookies are returned by
  [`cy.getCookie()`](/api/commands/getcookie), what cookies are set with
  [`cy.setCookie()`](/api/commands/setcookie), and the cookies cleared with
  [`cy.clearCookies()`](/api/commands/clearcookies). Addresses
  [#363](https://github.com/cypress-io/cypress/issues/363),
  [#5723](https://github.com/cypress-io/cypress/issues/5723) and
  [#24526](https://github.com/cypress-io/cypress/issues/24526)
- Cypress now throws an error if any Cypress commands are invoked from inside a
  [`.should()`](/api/commands/should) callback. This previously resulted in
  unusual and undefined behavior. Addresses
  [#5963](https://github.com/cypress-io/cypress/issues/5963),
  [#14656](https://github.com/cypress-io/cypress/issues/14656) and
  [#22587](https://github.com/cypress-io/cypress/issues/22587).

**Features:**

- Added a new Cypress command, called
  [`cy.getAllLocalStorage()`](/api/commands/getAllLocalStorage), to get
  [`localStorage`](https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage)
  data for all origins with which the test has interacted. Addresses
  [#24276](https://github.com/cypress-io/cypress/issues/24276).

- Added a new Cypress command, called
  [`cy.clearAllLocalStorage()`](/api/commands/clearAllLocalStorage), to clear
  [`localStorage`](https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage)
  data for all origins with which the test has interacted. Addresses
  [#24276](https://github.com/cypress-io/cypress/issues/24276).

- Added a new Cypress command, called
  [`cy.getAllSessionStorage()`](/api/commands/getAllSessionStorage), to get
  [`sessionStorage`](https://developer.mozilla.org/en-US/docs/Web/API/Window/sessionStorage)
  data for all origins with which the test has interacted. Addresses
  [#24276](https://github.com/cypress-io/cypress/issues/24276).

- Added a new Cypress command, called
  [`cy.clearAllSessionStorage()`](/api/commands/clearAllSessionStorage), to
  clear
  [`sessionStorage`](https://developer.mozilla.org/en-US/docs/Web/API/Window/sessionStorage)
  data for all origins with which the test has interacted. Addresses
  [#24276](https://github.com/cypress-io/cypress/issues/24276).

- Added a new configuration option called `experimentalOriginDependencies`. This
  option enables support using `require` and `import` with callback supplied to
  the [`cy.origin()`](/api/commands/origin) command in end-to-end testing.
  Previously this feature was enabled through the `experimentalSessionAndOrigin`
  configuration option. This was added as a configuration option in v12.0,
  instead of being enabled by default, due to increase node memory usage
  associated with this option that needs addressed before making this behavior
  generally available. Addressed in
  [#24931](https://github.com/cypress-io/cypress/pull/24931).

- Added a new `Cypress.ensure` API which provided several methods that can be
  helpful when writing customs command and custom query commands. Addressed in
  [#24697](https://github.com/cypress-io/cypress/pull/24697).

- Added a new "Run All" button to the
  [`experimentalRunAllSpecs`](guides/references/experiments#End-to-End-Testing)
  experiment which enables running all spec files returned from the
  `specPattern` glob or an array of globs, regardless of the specs sharing a
  root folder. Addresses
  [#24759](https://github.com/cypress-io/cypress/issues/24759).

**Bugfixes:**

- Fix a regression in [10.11.0](#10-11-0) where the Launchpad no longer showed a
  loading spinner on startup to indicate that it has successfully started an was
  a loading state. Fixed
  [#24950](https://github.com/cypress-io/cypress/issues/24950).

- Fixed the "Create Spec from Component" capability to correctly scaffold the
  component spec from a component which contains special characters in its name.
  Before this change, it scaffolded spec with either the wrong spec name or the
  incorrect component import which lead to invalid JS errors. Fixes
  [#23492](https://github.com/cypress-io/cypress/issues/23492).

- Corrected Cypress environment variable resolution to correctly resolve
  environment variables set with `npm config set`. Fixes
  [#24556](https://github.com/cypress-io/cypress/issues/24556).

- Fixed the console output returned from clicking on an aliased intercept in the
  Command Log. It now logs the yielded request/response object associated to the
  intercepted call when clicked, where previously it did not log these details.
  Fixed in [#24623](https://github.com/cypress-io/cypress/pull/24623).

- Added the missing Typescript types for the internal
  [`cy.now()`](/guides/guides/debugging#Run-Cypress-command-outside-the-test)
  command. Fixed in [#24697](https://github.com/cypress-io/cypress/pull/24697).

RAW NOTES:

SUMMARY: Cypress now fully supports for testing multiple domains of different
origins in a single test

Read more about 12.0 in
[our blog post](https://cypress.io/blog/2022/12/06/cypress-12-release/).

Breaking Changes:

- `experimentalSessionAndOrigin` flag has been removed and all functionality is
  now enabled by default now. Addresses
  [#21471](https://github.com/cypress-io/cypress/issues/21471).

- Added a new `testIsolation` configuration option, which defaults to `true`. To
  clear more about about w

  - Changes the testIsolation configuration values from on or off to true or
    false. Addressed in
    [#24935](https://github.com/cypress-io/cypress/pull/24935).

- The `cy.invoke()` -- need to find the PR again.

FIX:

- If [`cy.getCookie()`](/api/commands/getcookie) fails to find a cookie, you can
  no longer traverse the non-existent cookie's properties (eg, with
  .its('value)). If you expect a cookie not to exist, assert that directly, eg:
  cy.getCookie('foo1').should('not.exist'). Addressed in
  [#24203](https://github.com/cypress-io/cypress/pull/24203).
